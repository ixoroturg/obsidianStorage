---
tags:
  - combinatorics
---
## Основная теорема арифметики
Пусть $n \in N,\ n \geq 2$, то существуют такие простые числа $\{p_1,...p_s\}$ и такие натуральные $k_1,...k_s$, что есть единственное представление:
$$
n = p_1^{k_1} \cdot p_2^{k_2} \cdot ... \cdot p_s^{k_s}
$$

## Функция Мёбиуса
Функцией Мёбиуса называют это:
$$
\begin{gather*}
\mu(n) = 
\begin{dcases}
1, & n = 1 \\
(-1)^s, & n = p_1^1 \cdot ... \cdot p_s^1 \\
0, & иначе \\
\end{dcases}
\end{gather*}
$$
При $n \in \mathbb{N}$. Посмотрим несколько её значений: 

$\mu(1) = 1$, $\mu(2) = -1,$ $\mu(3) = -1,$ $\mu(4) = 0,$ $\mu(5) = -1,$ $\mu(6) = 1,$ $\mu(7) = -1,$ $\mu(8) = 0,$ $\mu(9) = 0,$ $\mu(10) = 1,$ $\mu(11) = -1,$ $\mu(12) = 0$.

Введём обозначение $d|n$, обозначающее, что `d делит n без остатка`, его аналог: $n\ \vdots\ d$, и выражение:
$$
\sum_{d|n} f(d)
$$
Означающее сумму значений функции $f$ по всем делителям числа $n$ (включая 1 и $n$). Например:
$$
\sum_{d|12} f(d) = f(1) + f(2) + f(3) + f(4) + f(6) + f(12)
$$

Лемма:
$$
\sum_{d|n} \mu(d) = 
\begin{dcases}
1, & n = 1 \\
0, & n \geq 2
\end{dcases}
$$

Доказательство:

Для $n = 1$ лемма очевидна, докажем для $n \geq 2$. По основной теореме арифметики:
$$
n = p_1^{k_1} \cdot p_2^{k_2} \cdot \ldots \cdot p_s^{k_s}
$$

Мы можем разложить $d|n$ как:
$$
d = p_1^{l_1} \cdot p_2^{l_2} \cdot \ldots \cdot p_s^{l_s}
$$
При этом $0 \leq l_s \leq k_s$. Тогда канонические разложения $d|12$ ($12 = 2^2 \cdot 3^1$) будут:
$$
\begin{gather*}
    d = 2^2 \cdot 3^1 = 12 \\
d = 2^1 \cdot 3^1 = 6 \\
d = 2^0 \cdot 3^1 = 3 \\
d = 2^2 \cdot 3^0 = 4 \\
d = 2^1 \cdot 3^0 = 2 \\
d = 2^0 \cdot 3^0 = 1
\end{gather*}
$$

Заметим, что $\mu(d) = 0$, при $\exists l_s \geq 2$ в силу определения функции Мёбиуса. Так что нам нужны остальные варианты, где $l_s$ либо 0 либо 1. Таких вариантов $2^s$. Каждое слагаемое это количество вариантов расстановки единиц на s нулей:
$$
\begin{gather*}
\sum_{d|n}\mu(d) = \mu(1) + (-1)^1 C^1_s + (-1)^2 C^2_s + (-1)^3 C^3_s + (-1)^4 C^4_s + ... + (-1)^s C^s_s
\end{gather*}
$$
И по [[Формула включений и исключений|формуле включений и исключений]] мы получаем, что это 0, при $s \geq 1$.

## Формула обращения Мёбиуса

Пусть есть функции $g(n)$ и $f(n) = \sum_{d|n} g(d)$, при $n \in \mathbb N$. Тогда:
$$
g(n) = \sum_{d|n} \mu(d) \cdot f\left(\frac{n}{d}\right)
$$
Или что то же самое:
$$
g(n) = \sum_{d|n} \mu \left(\frac{n}{d}\right) \cdot f(d)
$$
Потому что $\frac{n}{d}$ является делителем числа $n$, если $d$ делитель. Мы просто получаем другой делитель. Для $f(d)$ то же самое. Мы просто поменяли местами делители, нам всё равно надо суммировать по всем делителям, так что не важно, сначала по $d$ или по всем, кроме $d$.

Рассмотрим это формулу. Пусть $g(n) = n^2$ и $n = 12$. Тогда $g(12) = 12^2 = 4096$. Также мы определяли функцию:
$$
f(n) = \sum_{d|n}g(n)
$$
Поэтому:
$$
f(12) = 2^1 + 2^2 + 2^3 + 2^4 + 2^6 + 2^{12} = 4190
$$
Формула обращения утверждает:
$$
\begin{gather*}
g(12) = \mu(1)f\left(\frac{12}{1}\right) + \mu(2)f\left(\frac{12}{2}\right) + \\
\mu(3)f\left(\frac{12}{3}\right) + 
\mu(4)f\left(\frac{12}{4}\right) + \\
\mu(6)f\left(\frac{12}{6}\right) +
\mu(12)f\left(\frac{12}{12}\right) = \\
4190 - 78 - 22 + 0 + 6 + 0 = 4096
\end{gather*}
$$

### Доказательство формулы обращения Мёбиуса

В формулировке теоремы определена функция:
$$
f(n) = \sum_{d|n} g(d)
$$

Тогда:
$$
f\left(\frac{n}{d}\right) = \sum_{d' | \frac{n}{d}} g(d')
$$
Подставим это в:
$$
g(n) = \sum_{d|n} \mu(d) \cdot f\left(\frac{n}{d}\right)
$$
И получим:
$$
g(n) = \sum_{d|n} \mu(d) \cdot \left(\sum_{d'|\frac{n}{d}} g(d')\right)
$$
Рассмотрим далее:
$$
\begin{gather*}
g(n) = \sum_{d|n}\mu(d) \cdot \left(\sum_{d'|\frac{n}{d}} g(d')\right) = \sum_{(d,d')|n: d \cdot d'|n} \mu(d)g(d') = \\
= \sum_{(d,d')|n: d \cdot d'|n} \mu(d')g(d) = \sum_{d|n}g(d) \cdot \left(\sum_{d'|\frac{n}{d}} \mu(d') \right)
\end{gather*}
$$
Отделим слагаемое $d = n$ и получим:
$$
\begin{gather*}
\sum_{d|n}g(d) \cdot \left(\sum_{d'|\frac{n}{d}} \mu(d')\right) = g(n) \left(\sum_{d'|1} \mu(d')\right) + \sum_{d|n, d < n}g(d) \cdot \left(\sum_{d'|\frac{n}{d}} \mu(d')\right) 
\end{gather*}
$$
Первое слагаемое $g(n)\left(\sum_{d'|1} \mu(d')\right) = g(n) \cdot 1$. У второго слагаемого $\left(\sum_{d'|\frac{n}{d}} \mu(d')\right) = 0$, по лемме:
$$
\sum_{d|n}\mu(d) =
\begin{dcases}
1, & n = 1 \\
0, & n \geq 2
\end{dcases}
$$
Значит всё изначальное выражение равно $g(n)$, что и требовалось доказать.

## Откуда появляется $\mu(n)$

Нужно найти количество простых чисел от 1 до $n$. Для 12 нам нужно отсеять все числа, делящиеся на 2 и на 3. [[Формула включений и исключений|По формуле включений-исключений]]:
$$
f(12) = N - N\left(\frac{12}{2}\right) - N\left(\frac{12}{3}\right) + N \left(\frac{12}{2 \cdot 3}\right)
$$
Делитель 4 уже содержится в 2, поэтому его не надо включать. Функция Мёбиуса как раз исключает повторы и даёт чередующийся знак для этой функции. Формула обращения представляет из себя свёртку Дирихле, а $\mu(n)$ это обратный элемент в этой свёртке и является её ядром. Это уже отдельная большая тема.


Далее: [[Перечисление циклических последовательностей]] \
Предыдущее: [[Формула включений и исключений]] \
Основа: [[Комбинаторика]]